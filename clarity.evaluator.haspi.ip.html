<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>clarity.evaluator.haspi.ip module &#8212; Project name not set  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="clarity.evaluator.hasqi package" href="clarity.evaluator.hasqi.html" />
    <link rel="prev" title="clarity.evaluator.haspi.haspi module" href="clarity.evaluator.haspi.haspi.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-clarity.evaluator.haspi.ip">
<span id="clarity-evaluator-haspi-ip-module"></span><h1>clarity.evaluator.haspi.ip module<a class="headerlink" href="#module-clarity.evaluator.haspi.ip" title="Link to this heading">¶</a></h1>
<p>Functions for HASPI neural network stage.</p>
<dl class="py function">
<dt class="sig sig-object py" id="clarity.evaluator.haspi.ip.get_neural_net">
<span class="sig-prename descclassname"><span class="pre">clarity.evaluator.haspi.ip.</span></span><span class="sig-name descname"><span class="pre">get_neural_net</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/clarity/evaluator/haspi/ip.html#get_neural_net"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clarity.evaluator.haspi.ip.get_neural_net" title="Link to this definition">¶</a></dt>
<dd><p>Provide the weights derived for the ensemble of ten neural
networks used for the HASPI_v2 intelligibility model. The neural networks
have ten inputs, 4 neurons in the hidden layer, and one output neuron.
The logsig activation function is used.</p>
<p>Arguments: None</p>
<dl>
<dt>Returned values:</dt><dd><p>neural_net_params (dict): parameters defining the neural network
weights_hidden (): cell array 10 x 1 for the weights linking the input to the
hidden layer. Each cell is a 11 x 4 matrix of weights
weights_out (): call array 5 x 1 for the weights linking the hidden to the</p>
<blockquote>
<div><p>output layer. Each cell is a 5 x 1 vector of weights.</p>
</div></blockquote>
<dl class="simple">
<dt>normalization_factor (): normalization so that the maximum neural net output is</dt><dd><p>exactly 1.</p>
</dd>
</dl>
</dd>
<dt>Updates:</dt><dd><p>James M. Kates, 8 October 2019.
Version for new neural network using actual TFS scores, 24 October 2019.
Translated from MATLAB to Python by Zuzanna Podwinska, March 2022.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clarity.evaluator.haspi.ip.nn_feed_forward">
<span class="sig-prename descclassname"><span class="pre">clarity.evaluator.haspi.ip.</span></span><span class="sig-name descname"><span class="pre">nn_feed_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neural_net_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_hidden</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/clarity/evaluator/haspi/ip.html#nn_feed_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clarity.evaluator.haspi.ip.nn_feed_forward" title="Link to this definition">¶</a></dt>
<dd><p>Compute the outputs at each layer of a neural network given
the input to the network and the weights. The activation function is an
offset logistic function that gives either a logsig or hyperbolic
tangent; the outputs from each layer have been reduced by the offset. The
structure of the network is an input layer, one hidden layer, and an
output layer. The first values in vectors hidden and output are set to 1
by the function, and the remaining values correspond to the outputs at
each neuron in the layer.</p>
<p>Args:
data (np.ndarray): feature vector input to the neural network.
neural_net_params (dict): network parameters from get_neural_net().
weights_hidden (list): matrix of weights for the hidden layer.
weights_out (list): matrix of weights for the output layer.</p>
<p>Returns:
hidden (): vector of outputs from the hidden layer.
output (): vector of outputs from the output layer.</p>
<p>Updates:
James M. Kates, 26 October 2010.
Translated from MATLAB to Python by Zuzanna Podwinska, March 2022.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clarity.evaluator.haspi.ip.nn_feed_forward_ensemble">
<span class="sig-prename descclassname"><span class="pre">clarity.evaluator.haspi.ip.</span></span><span class="sig-name descname"><span class="pre">nn_feed_forward_ensemble</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neural_net_params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_hidden</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/clarity/evaluator/haspi/ip.html#nn_feed_forward_ensemble"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clarity.evaluator.haspi.ip.nn_feed_forward_ensemble" title="Link to this definition">¶</a></dt>
<dd><p>Function to compute the neural network ensemble response to a set of
inputs. The neural network is defined in NNfeedforwardZ.</p>
<p>Args:
data (np.ndarray): array of features input to the neural network
neural_net_params (dict): vector of neural network parameters
weights_hidden (list): cell array of hidden layer weights for each network
weights_out (list): cell array of output layer weights for each network</p>
<p>Returns:
model     neural network output vector averaged over the ensemble</p>
<p>Updates:
James M. Kates, 20 September 2011.
Translated from MATLAB to Python by Zuzanna Podwinska, March 2022.</p>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Project name not set</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes_doc.html">Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing to pyClarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="CODE_OF_CONDUCT.html">Contributor Covenant Code of Conduct</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="clarity.html">clarity package</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">recipes package</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="clarity.html">clarity package</a><ul>
  <li><a href="clarity.evaluator.html">clarity.evaluator package</a><ul>
  <li><a href="clarity.evaluator.haspi.html">clarity.evaluator.haspi package</a><ul>
      <li>Previous: <a href="clarity.evaluator.haspi.haspi.html" title="previous chapter">clarity.evaluator.haspi.haspi module</a></li>
      <li>Next: <a href="clarity.evaluator.hasqi.html" title="next chapter">clarity.evaluator.hasqi package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/clarity.evaluator.haspi.ip.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>